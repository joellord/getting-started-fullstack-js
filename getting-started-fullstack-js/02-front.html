<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Deploy the Front-End :: Getting Started with OpenShift for Full Stack JavaScript</title>
    <link rel="canonical" href="https://joellord.github.io/getting-started-fullstack-js/getting-started-fullstack-js/02-front.html">
    <link rel="prev" href="01-setup.html">
    <link rel="next" href="03-back.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../_/css/site.css">
<link rel="icon" href="../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img
          src="../_/img/header_logo.png" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" href="https://joellord.github.io/getting-started-fullstack-js">Getting Started with OpenShift for Full Stack JavaScript</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Books</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">CheatSheets</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">CheatSheet A</a>
            <a class="navbar-item" href="#">CheatSheet B</a>
            <a class="navbar-item" href="#">CheatSheet C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Upcoming Events</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Event A</a>
            <a class="navbar-item" href="#">Event B</a>
            <a class="navbar-item" href="#">Event C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Tutorial A</a>
            <a class="navbar-item" href="#">Tutorial B</a>
            <a class="navbar-item" href="#">Tutorial C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="getting-started-fullstack-js" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">Getting Started with OpenShift for Full Stack JavaScript</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="01-setup.html">Setup</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-setup.html#prerequisite">Prerequisites</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-setup.html#devsandbox">Create a Developer Sandbox Account</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-setup.html#oc">Configure <code>oc</code></a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-setup.html#locally">Run Application Locally</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="02-front.html">Deploy the Front-End</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#build">Build Container</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#push">Push to a registry</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#newapp">Deploy the front-end</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#expose">Expose the application</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#status">Verify application status</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03-back.html">Deploy the back-end</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-back.html#s2i">Use s2i</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-back.html#clienv">Configure environment variables</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-back.html#expose">Expose the application</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-back.html#health">Add a health check</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="04-env.html">Link the front-end and back-end</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-env.html#env">Add the BASE_URL variable</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-env.html#test">Test the application</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="05-db.html">Add a Database</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-db.html#catalog">Deploy from the catalog</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-db.html#env">Use the UI to configure env variables</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-db.html#frontenv">Edit front-end env variables</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-db.html#status">Verify the application status</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="06-redirector.html">Add a new micro-service</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="06-redirector.html#image">Add from existing image</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="06-redirector.html#env">Update Environment variables</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="06-redirector.html#status">Verify the status of the application</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Getting Started with OpenShift for Full Stack JavaScript</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Getting Started with OpenShift for Full Stack JavaScript</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Getting Started with OpenShift for Full Stack JavaScript</a></li>
    <li><a href="02-front.html">Deploy the Front-End</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/joellord/getting-started-fullstack-js/edit/master/documentation/modules/ROOT/pages/02-front.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Deploy the Front-End</h1>
<div id="preamble">
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In this section, you will see how to build a container for the front-end, if you want to skip this part and jump directly to the deployment part, you can also use a pre-existing image by jumping <a href="#deploy">here</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="build"><a class="anchor" href="#build"></a>Build a Container</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to deploy this applicatio, you can&#8217;t just use the same container that is used in development. That container is for a development environment and includes things such as a hot-reload server.</p>
</div>
<div class="paragraph">
<p>For your production environment, you will want to package up your React application and deploy in on an Nginx server. Ideally, it will be able to use environement variables to configure it and will be running as a non-root user for maximum security.</p>
</div>
<div class="paragraph">
<p>To find out more about how to build such containers, you can take a look at <a href="https://github.com/joellord/frontend-containers">this blog post</a>.</p>
</div>
<div class="paragraph">
<p>For this workshop, you will use the templates provided in that post.</p>
</div>
<div class="paragraph">
<p>First, start by copying the Dockerfile, nginx.conf and start-nginx.sh files from the aforementioned repository.</p>
</div>
<div class="listingblock container-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cd front
curl https://raw.githubusercontent.com/joellord/frontend-containers/main/react-project/Dockerfile.rootless -o Dockerfile
curl https://raw.githubusercontent.com/joellord/frontend-containers/main/react-project/start-nginx.sh -o start-nginx.sh
curl https://raw.githubusercontent.com/joellord/frontend-containers/main/react-project/nginx.conf -o nginx.conf</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to avoid copying all the node_modules folder in your container, you can also create a <code>.dockerignore</code> file.</p>
</div>
<div class="listingblock container-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">echo "node_modules" &gt; .dockerignore</code></pre>
</div>
</div>
<div class="paragraph">
<p>You are now ready to build this image.</p>
</div>
<div class="listingblock container-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker build -t urlshortener-front .</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you are using podman instead of docker, you will need to use the <code>--format=docker</code> parameter to push your image to <a href="https://hub.docker.com">Docker Hub</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="push"><a class="anchor" href="#push"></a>Push to a registry</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that you have an image ready to be deployed, you can use the <code>docker push</code> command to store this image into a registry. Feel free to use any registry for this step.</p>
</div>
<div class="paragraph">
<p>If you don&#8217;t have access to an image registry, you can create a free account on <a href="http://quay.io">Quay.io</a> or skip to <a href="#newapp">the deployment step</a> and use the image that is publicly available.</p>
</div>
<div class="paragraph">
<p>Use the CLI tool to push this image to a registry. Make sure that you replace `%REGISTRY_USERNAME% with your actual username</p>
</div>
<div class="listingblock container-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker push urlshortener-front %REGISTRY_USERNAME%/urlshortener-front</code></pre>
</div>
</div>
<div class="paragraph">
<p>This application image is now available to be used by OpenShift.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="newapp"><a class="anchor" href="#newapp"></a>Deploy the front-end</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You are now ready to deploy this image in your OpenShift cluster. Using the <code>oc</code> CLI tool, this can be done with a single command.</p>
</div>
<div class="listingblock container-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc new-app %REGISTRY_USERNAME/urlshortener-front</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you didn&#8217;t push your own custom image to a public registry, you can also use this image that has the latest version of the URL shortner front-end.</p>
</div>
<div class="listingblock container-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc new-app joellord/urlshortener-front</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
If you run into an error message about hitting a rate limit, take a look at <a href="https://developers.redhat.com/blog/2021/02/18/how-to-work-around-dockers-new-download-rate-limit-on-red-hat-openshift/">this blog post</a> for more details on how to work around it.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>OpenShift will now go and download that image from your registry and create a new application with it.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="expose"><a class="anchor" href="#expose"></a>Expose the application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The front-end has been deployed to your cluster, but there still isn&#8217;t a way to access it from the outside of the cluster.</p>
</div>
<div class="paragraph">
<p>To do so, you will need to expose the service that was just create with a <code>Route</code>. This can be done with a single command.</p>
</div>
<div class="listingblock container-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc expose svc/urlshortener-front --port=8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>You application is now fully deployed to OpenShift, and you should be able to see it in the Topology view of your application, as shown below.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/topology-view.png" alt="Topology view"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="status"><a class="anchor" href="#status"></a>Verify application status</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you click on the "Open URL" button next to your application in the topology view, it should open up your front-end application.</p>
</div>
<div class="paragraph">
<p>From here, you can view the list of redirection URLs (currently empty). You can also see the form to add new URLs (currently non-working). Finally, there is a third link in the navigation bar that leads to an "About" page. In there, you will see the status of the Node.js API, the Mongo database and the redirector service.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/shortener-about.png" alt="About dashboard from the front-end"></span></p>
</div>
<div class="paragraph">
<p>Right now, all indicators are red because the front-end doesn&#8217;t have a back-end to talk to. This will be adressed in the next section.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="01-setup.html">Setup</a></span>
  <span class="next"><a href="03-back.html">Deploy the back-end</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
